
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Marvel Match - Survey</title>

  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Exo:700" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/assets/css/survey.css">
</head>
<body>

  <div class="container">
    <form id="survey">

    <h2>Survey Questions</h2>
    <hr>

    <h3><strong>About You</strong></h3>
    <h4>Name (Required)</h4>
    <input type="text" id="name" class="form-control" required>

    <h4>Link to Photo Image (Required)</h4>
    <input type="text" id="photo" class="form-control" required>
    <hr>
    <ol id="surveyQuestions">
      <li id="q1" class="questions">
          <h3>Looks are EVERYTHING - I mean come on, look at me.</h3>
          <input type="radio" name="q1" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q1" value="2">2
          <br><input type="radio" name="q1" value="3">3
          <br><input type="radio" name="q1" value="4">4
          <br><input type="radio" name="q1" value="5">5 - Strongly Agree
      </li>
      <li id="q2" class="questions">
          <h3>There's no point in getting angry...just count to 10 backwards.</h3>
          <input type="radio" name="q2" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q2" value="2">2
          <br><input type="radio" name="q2" value="3">3
          <br><input type="radio" name="q2" value="4">4
          <br><input type="radio" name="q2" value="5">5 - Strongly Agree
      </li>
      <li id="q3" class="questions">
          <h3>Machine learning is great - we need to create more robots to do our work.</h3>
          <input type="radio" name="q3" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q3" value="2">2
          <br><input type="radio" name="q3" value="3">3
          <br><input type="radio" name="q3" value="4">4
          <br><input type="radio" name="q3" value="5">5 - Strongly Agree
      </li>
      <li id="q4" class="questions">
          <h3>You like to take lead, and tell others what to do.</h3>
          <input type="radio" name="q4" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q4" value="2">2
          <br><input type="radio" name="q4" value="3">3
          <br><input type="radio" name="q4" value="4">4
          <br><input type="radio" name="q4" value="5">5 - Strongly Agree
      </li>
      <li id="q5" class="questions">
          <h3>If you have money, spend it - especially on things that you can show off.</h3>
          <input type="radio" name="q5" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q5" value="2">2
          <br><input type="radio" name="q5" value="3">3
          <br><input type="radio" name="q5" value="4">4
          <br><input type="radio" name="q5" value="5">5 - Strongly Agree
      </li>
      <li id="q6" class="questions">
          <h3>When you walk into a social gathering, its usually because you're hosting it.</h3>
          <input type="radio" name="q6" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q6" value="2">2
          <br><input type="radio" name="q6" value="3">3
          <br><input type="radio" name="q6" value="4">4
          <br><input type="radio" name="q6" value="5">5 - Strongly Agree
      </li>
      <li id="q7" class="questions">
          <h3>No need for human force, my robot will take care of it.</h3>
          <input type="radio" name="q7" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q7" value="2">2
          <br><input type="radio" name="q7" value="3">3
          <br><input type="radio" name="q7" value="4">4
          <br><input type="radio" name="q7" value="5">5 - Strongly Agree
      </li>
      <li id="q8" class="questions">
          <h3>I'm the greatest, most efficient of them ALL.</h3>
          <input type="radio" name="q8" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q8" value="2">2
          <br><input type="radio" name="q8" value="3">3
          <br><input type="radio" name="q8" value="4">4
          <br><input type="radio" name="q8" value="5">5 - Strongly Agree
      </li>
      <li id="q9" class="questions">
          <h3>The only thing better than having your own company, is having your own building with your logo on it at the top of a sky scraper.</h3>
          <input type="radio" name="q9" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q9" value="2">2
          <br><input type="radio" name="q9" value="3">3
          <br><input type="radio" name="q9" value="4">4
          <br><input type="radio" name="q9" value="5">5 - Strongly Agree
      </li>
      <li id="q10" class="questions">
          <h3>If you're a genius, then flaunt it. Of course...I'm a genius!</h3>
          <input type="radio" name="q10" value="1" required>1 - Strongly Disagree
          <br><input type="radio" name="q10" value="2">2
          <br><input type="radio" name="q10" value="3">3
          <br><input type="radio" name="q10" value="4">4
          <br><input type="radio" name="q10" value="5">5 - Strongly Agree
      </li>
    </ul>
    <br>
    <!-- Submit Button -->
    <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">Submit</button>
  </form>
    <footer class="footer">
      <div class="container">
        <p><a href="/api/friends">API Friends List</a> | <a href="">GitHub Repo</a></p>
      </div>
    </footer>


  </div>

    <!-- Modal -->
    <div id="results-modal" class="modal" style=>
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h2 id="match-name" class="modal-title"><strong></strong></h2>
          </div>
          <div class="modal-body">
            <img id="match-img">
            <p id="match-bio"></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default close" data-dismiss="modal">Close</button>
          </div>
        </div>
  
      </div>
    </div>
  
    <script type="text/javascript">
      // Capture the form inputs
  $(document).ready(function () {
    var currentURL = window.location.origin;
    $("#submit").on("click", function(event) {
        // if either of the input fields is missing/blank, the data will not be submitted, and user will be prompted to answer
        if ($("#name").val() === "") {
          return;
        } 
        if ($("#photo").val() === "") {
          return;
        } 
      // create an array to keep track of unanswered questions
       var invalid = [];
        for (i=1; i < 11; i++) {
          var input = $(`input[name=q${i}]:checked`).val();
          // if a question is unanswered, the question number is thrown into the invalid array
          if (input === undefined && invalid.indexOf(i) === -1) {
            invalid.push(i);
          }
        }
        // our userData will not be sent until there are no more questions/input unanswered
        if (invalid.length === 0) {
          event.preventDefault();
          // saving userData as object to send to the server as a request
          var userData = {
            name: $("#name").val(),
            photo: $("#photo").val(),
            scores: [
            $('input[name=q1]:checked').val(),
            $('input[name=q2]:checked').val(),
            $('input[name=q3]:checked').val(),
            $('input[name=q4]:checked').val(),
            $('input[name=q5]:checked').val(),
            $('input[name=q6]:checked').val(),
            $('input[name=q7]:checked').val(),
            $('input[name=q8]:checked').val(),
            $('input[name=q9]:checked').val(),
            $('input[name=q10]:checked').val()
            ]
          };
          // jQuery to display modal with Matched Super hero
          $("#results-modal").css("display", "block");

          // AJAX post the data to the friends API
          $.post(currentURL + "/api/friends", userData).then(function(data) {
            // Grab the result from the AJAX post so that the best match's name / photo / bio are displayed
            $("#match-name").html(`Best Match: ${data.name}`);
            $("#match-img").attr("src", data.photo);
            $("#match-bio").html(data.bio);
          });
        }
    });
    // jQuery used to remove data from modal on close
      $(".close").on("click", function(event) {
        $("#results-modal").css("display", "none");
        $("#match-name").empty();
        $("#match-img").attr("src", ""); 
        $("form")[0].reset();
      });
});
</script>

</body>

</html>